# 🧩 【题型：IDOR（越权访问）

---

# 1. 题目类型

* URL 参数型 IDOR
* Header 伪造型 IDOR（）
* POST Body 参数越权
* 隐藏字段越权
* 前端绕过型越权（移除 JS 检查）
* 水平越权：访问不属于当前用户的资源
* 垂直越权：未授权的权限提升（如模拟 admin）

---

# 2. 解题输出思路

1. 获取 session / token（如题目要求）
2. 寻找所有含对象编号的字段（id / uid / order / group / receipt）
3. 枚举相邻 ID（200/403/404 差异判断权限）
4. 若支持自定义 header → 尝试用 Header 覆盖真实用户
5. 对资源型接口（receipt/archive/log）做组合访问
6. 从成功访问的页面/JSON 中提取 flag

---

# 3. 解题关注点（合并后的核心集合）

* 后端是否真正检查“资源所有者”而不是仅检查 session
* 是否存在能“覆盖身份”的 Header（如 `X-Auth-User`、`X-UserId`）
* 是否有隐藏字段
* 是否存在连续的 ID 空间（订单号、文章 ID）
* 不同用户访问相同 ID 时响应是否有差异（长度/字段/状态码）
* 是否存在间接接口

---

# 4. 通用步骤

## ✔ 通用步骤（所有 IDOR 通用）

* 对所有接口进行 **ID fuzz（连续 ID 测试）**
* 观察 **响应长度/字段差异** 判断是否越权成功
* 检查是否存在未公开的全局接口
* 使用多种 HTTP 方法（GET/POST/PUT/DELETE）测试权限
* 对所有参数（URL / Body / Cookie / Header）做一致性检查

---

# 5. 解题方法论（精炼归纳版）

* **ID → 用户属性 → 对象关系模型**
  判断对象是否应该属于当前用户。
* **错误差异推理法**
  通过状态码/响应大小/字段逻辑推断越权点。
* **多入口测试法**
  表面接口不返回 flag → 尝试归档/导出/批量接口。
* **身份覆盖法**
  使用 Header / Cookie / Body 强制“模拟他人身份”。

---

# 6. 启发性问题（去重优化版）

AI 在解题时应自问：

* 这个资源是否与当前用户绑定？
* 是否存在“只靠 session，不校验资源归属”的接口？
* 能否修改 URL ID 来访问他人资源？
* 是否存在能覆盖身份的 header？
* 成功请求与失败请求的差异是什么？
* 是否存在“间接路径”获取 flag（如归档后读取）？

---

# 7. 绕过手法（扩展+去重）

* 连续 ID 模糊测试
* Header 覆盖身份
* Body 字段注入
* 移除前端校验并直接构造请求
* Cookie 中注入字段覆盖用户
* 修改 URI 结构

---



